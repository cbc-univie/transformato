

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>System Setup &mdash; transformato  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Documentation" href="api.html" />
    <link rel="prev" title="Installation" href="Installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> transformato
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">System Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#file-structure-and-supplying-your-protein-ligand">File structure and supplying your protein/ligand</a></li>
<li class="toctree-l2"><a class="reference internal" href="#restraints">Restraints</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#automatic-restraints">Automatic Restraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="#manual-restraints">Manual Restraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">transformato</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>System Setup</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/System_Setup.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="system-setup">
<h1>System Setup<a class="headerlink" href="#system-setup" title="Permalink to this headline">¶</a></h1>
<p>After successfully installing transformato, you can now setup your first system. For this, you require three items:</p>
<ul class="simple">
<li><p>The output of [CHARMM-GUI](<a class="reference external" href="http://www.charmm-gui.org/)'s">http://www.charmm-gui.org/)’s</a> solution builder for your ligand - solvated once at its position within the protein-ligand complex and once in a pure waterbox.</p></li>
<li><p>A <cite>config.yaml</cite> which describes your general simulation parameters</p></li>
<li><p>A <cite>submit.ipynb</cite> (or just standard .py) that generates your intermediate states</p></li>
</ul>
<p>Finally, to actually analyze your simulations and calculate the resulting free energies, you’ll need an <cite>analysis.py</cite> script - this is covered on the <em>Analysis</em> page.</p>
<section id="file-structure-and-supplying-your-protein-ligand">
<h2>File structure and supplying your protein/ligand<a class="headerlink" href="#file-structure-and-supplying-your-protein-ligand" title="Permalink to this headline">¶</a></h2>
<p>Please refer to this convenient and practical flowchart to understand transformato’s folder structure:
.. image:: <a class="reference external" href="https://user-images.githubusercontent.com/79014444/169664208-56cc9d73-bd93-49ed-8f06-14cc15c04f34.svg">https://user-images.githubusercontent.com/79014444/169664208-56cc9d73-bd93-49ed-8f06-14cc15c04f34.svg</a></p>
<p>While this may look complicated, all you need to do is to:
1. Create a folder called <cite>your-structure-1</cite> for your first structure
2. Take the CHARMM-GUI output folder (called something like charmm-gui-4842148) for your solvated ligand-protein complex, move it to this folder and rename it into <cite>complex</cite>
3. Take the CHARMM-GUI output folder for your solvated ligand in the waterbox, move it to this folder and rename it inti <cite>waterbox</cite>
4. Do the same with your second, third, fourth… etc. structure
5. <strong>Run the equillibration</strong> part of the provided simulation input. An equillibrated system (and the generated .rst file) are necesary for transformato.</p>
<p>You`ll create the remaining files down below.</p>
<p>## The config.yaml</p>
<p>## The submit script</p>
</section>
<section id="restraints">
<h2>Restraints<a class="headerlink" href="#restraints" title="Permalink to this headline">¶</a></h2>
<p>WARNING: The documentation here is not yet implemented and more aspirational/for development branches</p>
<p><strong>OpenMM only</strong></p>
<p>Transformato supports two types of restraints: automatic and manual restraints.</p>
</section>
</section>
<section id="automatic-restraints">
<h1>Automatic Restraints<a class="headerlink" href="#automatic-restraints" title="Permalink to this headline">¶</a></h1>
<p>To activate automatic restraints for your ligand, add</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">simulation</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">restraints</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;auto&quot;</span><span class="w"></span>
</pre></div>
</div>
<p>to your <cite>config.yaml</cite>. This wil restrain your ligand in its original position using a harmonic potential of the form <cite>E=0.5*k*(r-r0)²</cite> (where  r is the current distance, r0 the initial distance, and k the force constant), applied within the centers of mass of your ligand and the surrounding protein structure, keeping these two vaguely fixed.</p>
<p>You may specify further keywords:</p>
<p><em>Keywords for restraints:</em>
<a href="#id5"><span class="problematic" id="id6">|Keyword|Values|Description|</span></a>
<a href="#id7"><span class="problematic" id="id8">|-------|</span></a>——-<a href="#id9"><span class="problematic" id="id10">|----|</span></a>
<a href="#id11"><span class="problematic" id="id12">|`k=`|`[int]`|*(optional)* Specifies the force constant. Default value is 3. Sensible values are between 0.1 - 500, depending on the system, but tougher restraints have larger impact on system sampling and accuracy of free energy calculations. Default is `k=3`
|`extremities=` |`[int]`|*(optional)* Instead of restraining the entire common core by its center of mass, attaches `n` bonds to the calculated extremities of the ligand and nearby protein structures, thus cutting down on rotational freedom. If not specified, the entire ligand is restrained by its center of mass
|`shape=`|`harmonic` `flatbottom`|*(optional)* Exchanges the harmonic potential underlying the restraints for a flat-bottomed one of the form `step(r-r_0) · (K/2)·(r-r_0)^2` Default is `harmonic`
|`scaling`|Presence toggles|*(optional)* Linearly scales the k value through the first 4 states (0, 0.25, 0.5, 0.75). Default is `False`|</span></a></p>
<p>A full command might thus look like this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">restraints</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;auto</span><span class="nv"> </span><span class="s">k=10</span><span class="nv"> </span><span class="s">extremities=3</span><span class="nv"> </span><span class="s">shape=harmonic</span><span class="nv"> </span><span class="s">scaling&quot;</span><span class="w"></span>
</pre></div>
</div>
<p>CAUTION: Be somewhat sure of what your structure looks like, and do a sanity check on the generated restraints before production. As all restraints only act on the common core, setting an arbitrarily high number of extermities can lead to strange results</p>
<p>It should be noted that this means that a small file called <cite>restraints.yaml</cite> is created in your <cite>intst*</cite> - folders.
These have the following structure:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">system</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">structure</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">tlc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LIG</span><span class="w"> </span><span class="c1"># same as in the config.yaml, but only one structure (as only one relevant)</span><span class="w"></span>

<span class="nt">simulation</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">restraints</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;auto&quot;</span><span class="w"> </span><span class="c1"># same as in config.yaml</span><span class="w"></span>
<span class="w">    </span><span class="nt">ccs</span><span class="p">:</span><span class="w">  </span><span class="c1"># this represents an array of your common core, upon which restraints can be applied</span><span class="w"></span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">C1</span><span class="w"></span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">C2</span><span class="w"></span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">H2</span><span class="w"></span>
<span class="nt">intst</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">scaling:0.8</span><span class="w"> </span><span class="c1"># for non-immediate switches, how far along the scaling is. Only relevant for harmonic potentials.</span><span class="w"></span>
</pre></div>
</div>
<p>It is not recommended to manually edit these files, as they are automatically created for each intermediate state.</p>
</section>
<section id="manual-restraints">
<h1>Manual Restraints<a class="headerlink" href="#manual-restraints" title="Permalink to this headline">¶</a></h1>
<p>To activate manual restraints for your ligand, add</p>
<p><em>config.yaml</em></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">simulation</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">restraints</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;manual&quot;</span><span class="w"></span>
</pre></div>
</div>
<p>to your config.yaml. Below, you may now specify an arbitrary number of restraints using the [MDAnalysis selection syntax](<a class="reference external" href="https://docs.mdanalysis.org/stable/documentation_pages/selections.html#simple-selections">https://docs.mdanalysis.org/stable/documentation_pages/selections.html#simple-selections</a>):</p>
<p><em>config.yaml</em></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">simulation</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">restraints</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;manual&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nt">manualrestraints</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">restraint1</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">shape</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;harmonic&quot;</span><span class="w"></span>
<span class="w">            </span><span class="nt">group1</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;resname</span><span class="nv"> </span><span class="s">LIG</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">type</span><span class="nv"> </span><span class="s">C&quot;</span><span class="w"></span>
<span class="w">            </span><span class="nt">group2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;protein</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">type</span><span class="nv"> </span><span class="s">CA&quot;</span><span class="w"></span>
<span class="w">            </span><span class="nt">k</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span><span class="w"></span>
<span class="w">            </span><span class="nt">r0</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2.41</span><span class="w"></span>
</pre></div>
</div>
<p>You may define as many restraints as you like:</p>
<p>Code example with many restraints:</p>
<p><em>config.yaml</em></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">simulation</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">restraints</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;manual&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nt">manualrestraints</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">restraint1</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">shape</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;harmonic&quot;</span><span class="w"></span>
<span class="w">            </span><span class="nt">group1</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;resname</span><span class="nv"> </span><span class="s">LIG</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">type</span><span class="nv"> </span><span class="s">C&quot;</span><span class="w"></span>
<span class="w">            </span><span class="nt">group2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;protein</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">type</span><span class="nv"> </span><span class="s">CA&quot;</span><span class="w"></span>
<span class="w">        </span><span class="nt">restraint2</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">shape</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;flatbottom&quot;</span><span class="w"></span>
<span class="w">            </span><span class="nt">group1</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;resname</span><span class="nv"> </span><span class="s">LIG</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">type</span><span class="nv"> </span><span class="s">C&quot;</span><span class="w"></span>
<span class="w">            </span><span class="nt">group2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;protein</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">type</span><span class="nv"> </span><span class="s">CA&quot;</span><span class="w"></span>
<span class="w">        </span><span class="nt">restraint3</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">shape</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;harmonic&quot;</span><span class="w"></span>
<span class="w">            </span><span class="nt">group1</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;resname</span><span class="nv"> </span><span class="s">LIG</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">name</span><span class="nv"> </span><span class="s">C14&quot;</span><span class="w"></span>
<span class="w">            </span><span class="nt">group2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;sphlayer</span><span class="nv"> </span><span class="s">5</span><span class="nv"> </span><span class="s">15</span><span class="nv"> </span><span class="s">name</span><span class="nv"> </span><span class="s">C14</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">protein</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">type</span><span class="nv"> </span><span class="s">CA&quot;</span><span class="w"></span>
</pre></div>
</div>
<p><a href="#id13"><span class="problematic" id="id14">|Keyword|Values|Description|</span></a>
<a href="#id15"><span class="problematic" id="id16">|-------|</span></a>——-<a href="#id17"><span class="problematic" id="id18">|-------------|</span></a>
<a href="#id19"><span class="problematic" id="id20">|`shape`|`&quot;harmonic&quot;` `&quot;flatbottom&quot;`|Shape of the energy potential. Default is &quot;harmonic&quot;|</span></a>
<a href="#id21"><span class="problematic" id="id22">|`group1` `group2`|Any [MDAnalysis selection string](https://docs.mdanalysis.org/stable/documentation_pages/selections.html#simple-selections)|Defines which Common Core atoms are members of group1 or group2. Please note that group1 **must** be the ligand, and group2 the protein.|</span></a>
<a href="#id23"><span class="problematic" id="id24">|`k`|`[float]`|*(optional)*: Defines the harmonic force constant. Default is 3.|</span></a>
<a href="#id1"><span class="problematic" id="id2">|</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>r0`|`[float]`|*(optional)*: <strong>Harmonic Potential:</strong> By default, forces are 0 when the atom groups have their initial distance to each other. By setting this parameter, you may define a custom r0, allowing you to push or pull atom groups.  <strong>Flat-Bottom Potential:</strong> Represents the well size. Defaults to 1.5</p>
<p>As with automatic restraints, even manually specified restraints will never act on atoms not in the common core, as this would lead to nonsensical energy calculations.</p>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api.html" class="btn btn-neutral float-right" title="API Documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Marcus Wieder. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.1

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>