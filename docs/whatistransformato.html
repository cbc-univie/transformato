

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>\(\texttt{TRANSFORMATO}\) in a nutshell &mdash; transformato  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installation" href="Installation.html" />
    <link rel="prev" title="Welcome to the \(\texttt{TRANSFORMATO}\) documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/logo_transformato.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#"><span class="math notranslate nohighlight">\(\texttt{TRANSFORMATO}\)</span> in a nutshell</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-common-core-approach">The common-core approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="#citations-license-and-contact">Citations, License and Contact</a></li>
<li class="toctree-l2"><a class="reference internal" href="#acknowledgements">Acknowledgements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="System_Setup.html">System Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="Running_Simulation.html">Running Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Analysis.html">Trajectory Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="Troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">transformato</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li><span class="math notranslate nohighlight">\(\texttt{TRANSFORMATO}\)</span> in a nutshell</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/whatistransformato.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="trafo-in-a-nutshell">
<h1><span class="math notranslate nohighlight">\(\texttt{TRANSFORMATO}\)</span> in a nutshell<a class="headerlink" href="#trafo-in-a-nutshell" title="Permalink to this heading">¶</a></h1>
<p><span class="math notranslate nohighlight">\(\texttt{TRANSFORMATO}\)</span> <a class="footnote-reference brackets" href="#fspeedlimits" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> is a python package designed to calculate
either <strong>relative binding free energies</strong> (RBFE) or <strong>relative solvation free energies</strong> (RSFE) between two similiar
ligands. The two ligands are the two physical endstates which are mutated to a common core structure.</p>
<p>For that reason, <span class="math notranslate nohighlight">\(\texttt{TRANSFORMATO}\)</span> first searches for the common core (Common Core approach). All atoms which are not part of this
CC and thus differ between the two ligands are then turned off step-wise. First,
electrostatic contributions of the non-CC atoms are turned off, followed by turning off the Lennard-Jones (LJ) interactions
of the non-CC atoms. For the non-hydrogen atoms this is done on an atom-by-atom basis (Serial-Atom-Insertion approach).
This is done in both environments, for RSFE; ligand in vacuum and ligand solvated in water. For RBFE; ligand solvated in
water and ligand solvated in water and bound to the receptor (protein).</p>
<p><span class="math notranslate nohighlight">\(\texttt{TRANSFORMATO}\)</span> will create intermediate state folders to connect each ligand with its common core structure.
Each folder will contain a plain MD simulation, which can be run individually from all other simulations. Finally, for
each ligand the free energy accrding to the common core structure can be calculated. Since both common core structures
are the same, the resulting free energy difference <span class="math notranslate nohighlight">\(\Delta\Delta G^{bind}_{L1\rightarrow L2}\)</span> can  be obtained.</p>
<section id="the-common-core-approach">
<h2>The common-core approach<a class="headerlink" href="#the-common-core-approach" title="Permalink to this heading">¶</a></h2>
<p>With standard alchemical FES, the two endpoints are generally transformed directly into each other, with bonded and nonbonded forces scaled according to the coupling parameter <span class="math notranslate nohighlight">\(\lambda\)</span>, while introducing dummy atoms to ensure a constant number of particles in the system<a class="footnote-reference brackets" href="#fshirts" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>.</p>
<p>With transformato however, the structures are not transformed into each other directly. Instead, each structure is transformed into a ‘common core’, a common topology to both systems (ideally - and usually - the <em>maximum</em> common topology between systems), with the free energy being the sum of free energies necessary to reach the common core:</p>
<div class="math notranslate nohighlight">
\[\Delta\Delta G^{bind}_{L1\rightarrow L2} = \Delta\Delta G^{bind}_{L1\rightarrow |DL_1| - R_{CC}} - \Delta\Delta G^{bind}_{L2\rightarrow\ |DL_2| - R_{CC}}\]</div>
<p><span class="math notranslate nohighlight">\(|DL_1|\)</span> and <span class="math notranslate nohighlight">\(|DL_2|\)</span> refer to the dummy regions of Endstate 1 and 2 respectively. <span class="math notranslate nohighlight">\(R_{CC}\)</span> refers to the common core.</p>
<p>The main advantage of this (and transformato as a whole) is that it generally cuts down enormously on the number of simulations required - while a typical alchemical FES will require 20 to 30 intermediate states, transformato may require as little as 14<a class="footnote-reference brackets" href="#fjohannes" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>, further reducing simulation time in conjunction with SAI.</p>
</section>
<section id="citations-license-and-contact">
<h2>Citations, License and Contact<a class="headerlink" href="#citations-license-and-contact" title="Permalink to this heading">¶</a></h2>
<p>Transformato is released under the MIT License. For further information, visit the <a class="reference external" href="https://github.com/wiederm/transformato/blob/master/LICENSE">repository license page</a>.</p>
<div class="admonition-todo admonition">
<p class="admonition-title">todo</p>
<p>Have Johannes give contact information and list desired citations</p>
</div>
</section>
<section id="acknowledgements">
<h2>Acknowledgements<a class="headerlink" href="#acknowledgements" title="Permalink to this heading">¶</a></h2>
<p>Apart from the default python packages, transformato relies in large parts on the following packages:</p>
<ul class="simple">
<li><p>MDAnalysis<a class="footnote-reference brackets" href="#fmdanalysis1" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a> <a class="footnote-reference brackets" href="#fmdanalysis2" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a> : Used for general purpose protein and ligand analysis, atom selection and especially trajectory analysis.</p></li>
<li><p>Numpy<a class="footnote-reference brackets" href="#fnumpy1" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>7<span class="fn-bracket">]</span></a> : Well, its numpy. We use it for math.</p></li>
<li><p>parmed<a class="footnote-reference brackets" href="#fparmed1" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>9<span class="fn-bracket">]</span></a> : Protein structure manipulations.</p></li>
<li><p>pymbar<a class="footnote-reference brackets" href="#fpymbar" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>8<span class="fn-bracket">]</span></a> : mBAR analysis.</p></li>
<li><p>RDKit: Visualisation of molecular structures.</p></li>
</ul>
<p class="rubric">References</p>
<aside class="footnote brackets" id="fspeedlimits" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Wieder, M., Fleck, M., Braunsfeld, B., and Boresch, S. (2022). <em>Alchemical free energy simulations without speed limits. A generic framework to calculate free energy differences independent of the underlying molecular dynamics program.</em> J. Comput. Chem. 43, 1151–1160, <a class="reference external" href="https://doi.org/10.1002/jcc.26877">DOI ⤶</a></p>
</aside>
<aside class="footnote brackets" id="fboreschbruckner" role="note">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Boresch, S., Bruckner, S. (2011). <em>Avoiding the van der Waals endpoint problem using serial atomic insertion</em> J.Comput. Chem. 2011,32, 2449–2458, <a class="reference external" href="https://onlinelibrary.wiley.com/doi/abs/10.1002/jcc.21829">DOI ⤶</a></p>
</aside>
<aside class="footnote brackets" id="fshirts" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">3</a><span class="fn-bracket">]</span></span>
<p>Shirts, M. R., Mobley, D. L. and Chodera, J. D. (2007). <em>Alchemical free energy calculations: Ready for prime time?</em>  Annual Reports in Computational Chemistry, Vol. 3</p>
</aside>
<aside class="footnote brackets" id="fjohannes" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">4</a><span class="fn-bracket">]</span></span>
<p>Karwounopoulos, J., Wieder, M., and Boresch, S. (2022). <em>Relative binding free energy calculations with Transformato: a molecular dynamics engine-independent tool.</em> frontiers, <em>submitted</em>.</p>
</aside>
<aside class="footnote brackets" id="fmdanalysis1" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">5</a><span class="fn-bracket">]</span></span>
<p>Gowers, R. et al., 2016. <em>MDAnalysis: A Python Package for the Rapid Analysis of Molecular Dynamics Simulations</em>. In Proceedings of the Python in Science Conference.  SciPy.</p>
</aside>
<aside class="footnote brackets" id="fmdanalysis2" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">6</a><span class="fn-bracket">]</span></span>
<p>Michaud-Agrawal, N. et al., 2011. <em>MDAnalysis: A toolkit for the analysis of molecular dynamics simulations</em>. Journal of Computational Chemistry, 32(10), pp.2319–2327.</p>
</aside>
<aside class="footnote brackets" id="fnumpy1" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id6">7</a><span class="fn-bracket">]</span></span>
<p>Van Der Walt, S., Colbert, S.C. &amp; Varoquaux, G., 2011. <em>The NumPy array: a structure for efficient numerical computation</em>. Computing in Science &amp; Engineering, 13(2), pp.22–30.</p>
</aside>
<aside class="footnote brackets" id="fpymbar" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id8">8</a><span class="fn-bracket">]</span></span>
<p>Shirts MR and Chodera JD. <em>Statistically optimal analysis of samples from multiple equilibrium states.</em> J. Chem. Phys. 129:124105 (2008). <a class="reference external" href="http://dx.doi.org/10.1063/1.2978177">DOI ⤶</a></p>
</aside>
<aside class="footnote brackets" id="fparmed1" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id7">9</a><span class="fn-bracket">]</span></span>
<p>Michael R. Shirts, Christoph Klein et al., <em>2016. Lessons learned from comparing molecular dynamics engines on the SAMPL5 dataset</em>. Journal of Computer-Aided Molecular Design</p>
</aside>
</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Installation.html" class="btn btn-neutral float-right" title="Installation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to the \(\texttt{TRANSFORMATO}\) documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022, Marcus Wieder, Johannes Karwounopoulos, Stefan Boresch. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.1

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>