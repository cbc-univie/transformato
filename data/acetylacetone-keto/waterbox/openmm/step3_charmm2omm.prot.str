* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) v3.2.2 on Feb, 20. 2021. JOBID=1386117359
* POSITIONAL RESTRAINT POTENTIALS FOR PROTEINS
*

define PROT sele none end
define CARB sele none end
define HETE sele ( segid HETA ) end

define BB   sele ( ( type C   .or. type O   .or. type N   .or. type CA  .or. -
                     type P   .or. type O1P .or. type O2P .or. type O5' .or. -
                     type C5' .or. type C4' .or. type C3' .or. type O3' ) .and. PROT ) .or. -
                 ( ( type C+ .or. ( type O5 .and. .bonded. type C1 ) .or. ( type O6 .and. .bonded. type C2 ) ) .and. CARB ) .or. -
                 ( .not. hydrogen .and. HETE ) end

set nbb = ?nsel
define SC   sele .not. BB .and. .not. hydrogen .and. ( PROT .or. CARB ) end
set nsc = ?nsel

calc nposres = @nbb + @nsc
if nposres .eq. 0 return

open write unit 52 card name openmm/restraints/prot_pos.txt

if nbb .gt. 0 then
   coor stat sele BB end
   set iatom = ?selatom

   label ibb
      coor stat sele BB .and. bynu @iatom:?natom end
      set iatom   = ?selatom
      calc index0 = @iatom - 1

      write title unit 52
      * @index0 BB
      *

      incr iatom by 1
   if ?nsel .gt. 1 goto ibb
endif

if nsc .gt. 0 then
   coor stat sele SC end
   set iatom = ?selatom

   label isc
      coor stat sele SC .and. bynu @iatom:?natom end
      set iatom  = ?selatom
      calc index0 = @iatom - 1

      write title unit 52
      * @index0 SC
      *

      incr iatom by 1
   if ?nsel .gt. 1 goto isc
endif      

